<section id="product-list" class="product-store position-relative padding-large">
  <div class="container">
    <div class="row">

      <!-- {{!-- ========== SIDEBAR CATEGORY ========== --}} -->
      <aside class="col-md-3 mb-4 mb-md-0">
        <h5 class="text-uppercase mb-3">Categories</h5>
        <ul class="list-group list-group-flush">
          {{#each categories}}
          <li class="list-group-item px-0 py-2">
            <a href="/products/category/{{this.id}}"
               class="text-decoration-none 
                      {{#if this.isActive}}
                        fw-bold text-primary
                      {{else}}
                        text-dark
                      {{/if}}">
              {{this.name}}
            </a>
          </li>
          {{/each}}
        </ul>
      </aside>

      <!-- {{!-- ========== PRODUCT LIST CONTENT ========== --}} -->
      <div class="col-md-9">

        <!-- {{!-- Header: Category Name + Sorting --}} -->
        <div class="d-flex justify-content-between align-items-center mb-4">
          <div>
            <h2 class="display-7 text-dark text-uppercase mb-0">
              {{currentCategory.name}}
            </h2>
            <small class="text-muted">{{total}} products found</small>
          </div>

        </div>

        {{!-- ========== PRODUCT GRID ========== --}}
        {{#if products.length}}
        <div class="row g-4">

          {{#each products}}
          <div class="col-sm-6 col-lg-4">
            <div class="product-card position-relative h-100">

              <div class="image-holder">
                <a href="/products/{{this.id}}">
                  <img src="{{this.thumbnail}}" 
                       alt="{{this.name}}" 
                       class="img-fluid">
                </a>
              </div>

              <div class="cart-concern position-absolute">
                <div class="cart-button d-flex">
                  <a href="/watch/add/{{this.id}}" 
                     class="btn btn-medium btn-black">
                    Add to Watchlist
                  </a>
                </div>
              </div>

              <div class="card-detail pt-3">
                <h3 class="card-title text-uppercase mb-1">
                  <a href="/products/{{this.id}}">{{this.name}}</a>
                </h3>

                <div class="d-flex justify-content-between align-items-baseline">
                  <span class="item-price text-primary">
                    ${{this.currentPrice}}
                  </span>

                  {{#if this.buyNowPrice}}
                  <span class="text-muted small">
                    Buy now: ${{this.buyNowPrice}}
                  </span>
                  {{/if}}
                </div>

                <div class="d-flex justify-content-between mt-1 small text-muted">
                  <span>{{this.bidCount}} bids</span>
                  <span>{{this.timeRemaining}}</span>
                </div>
              </div>

            </div>
          </div>
          {{/each}}

        </div>
        {{else}}
        <p class="text-muted">No products found.</p>
        {{/if}}

        {{!-- ========== PAGINATION ========== --}}
        {{#if pageNumbers.length}}
        <nav aria-label="Product pagination" class="mt-4">
          <ul class="pagination justify-content-center">

            {{#if hasPrev}}
            <li class="page-item">
              <a class="page-link" 
                 href="/products/category/{{currentCategory.id}}?page={{prevPage}}&sort={{sort}}">
                &laquo;
              </a>
            </li>
            {{/if}}

            {{#each pageNumbers}}
            <li class="page-item {{#if this.isCurrent}}active{{/if}}">
              <a class="page-link"
                 href="/products/category/{{../currentCategory.id}}?page={{this.value}}&sort={{../sort}}">
                {{this.value}}
              </a>
            </li>
            {{/each}}

            {{#if hasNext}}
            <li class="page-item">
              <a class="page-link" 
                 href="/products/category/{{currentCategory.id}}?page={{nextPage}}&sort={{sort}}">
                &raquo;
              </a>
            </li>
            {{/if}}

          </ul>
        </nav>
        {{/if}}

      </div>
    </div>
  </div>
</section>
